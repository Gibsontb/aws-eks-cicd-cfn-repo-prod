# ============================================================
# Author: TGibson
# File: deploy/bootstrap.conf
# Repo: AWS EKS CI/CD (Commercial + GovCloud) via CloudFormation
# Version: 1.1
# Date: 2025-08-27
# ============================================================

# ---------- App identifiers ----------
APP_NAME="myservice"                 # CFN/pipeline prefix
REPO_NAME="myservice"                # CodeCommit repo name
ECR_REPO_NAME="myservice"            # ECR repo name
SOURCE_BRANCH="main"                 # CodeCommit branch the pipeline watches

# ---------- Commercial (public) partition (REQUIRED) ----------
COMM_ACCOUNT_ID=""                   # e.g. 111111111111
COMM_REGION="us-east-1"
COMM_VPC_ID=""                       # vpc-xxxxxxxx
COMM_PRIVATE_SUBNET_IDS=""           # comma-separated: subnet-aaa,subnet-bbb
COMM_CODEBUILD_SG_ID=""              # sg-xxxxxxxx

# ---------- GovCloud (private) partition (OPTIONAL) ----------
GOV_ACCOUNT_ID=""                    # leave empty to skip GovCloud
GOV_REGION="us-gov-west-1"
GOV_VPC_ID=""
GOV_PRIVATE_SUBNET_IDS=""
GOV_CODEBUILD_SG_ID=""

# ---------- Cluster & namespace names (override if yours differ) ----------
DEV_CLUSTER_NAME="eks-dev"
STG_CLUSTER_NAME="eks-stg"
PRD_CLUSTER_NAME="eks-prod"

DEV_NAMESPACE="app-dev"
STG_NAMESPACE="app-stg"
PRD_NAMESPACE="app-prod"

# ---------- Supply chain security (cosign over KMS) ----------
# Create an asymmetric KMS key (ECC P-256/P-384) and grant the build role kms:Sign/GetPublicKey
COSIGN_KMS_ALIAS="alias/myservice-cosign"

# ---------- Notifications (OPTIONAL) ----------
NOTIFY_EMAIL=""                      # e.g. you@example.com

# ---------- Ingress / DNS / TLS (OPTIONAL but recommended for prod) ----------
# Set these to have the bootstrap stamp your prod Helm values for ALB ingress
PROD_DOMAIN=""                       # e.g. api.example.com
PROD_CERT_ARN=""                     # ACM cert ARN in the ALB region (Commercial)
PROD_WAF_ARN=""                      # Optional: WAFv2 WebACL ARN for ALB

# ---------- Identity (OPTIONAL – pick one path) ----------
# If using Cognito:
COGNITO_USER_POOL_ID=""              # e.g. us-east-1_xxxxx
COGNITO_USER_POOL_CLIENT_ID=""
COGNITO_ISSUER_URL=""                # e.g. https://cognito-idp.us-east-1.amazonaws.com/<pool_id>

# If using external OIDC/SAML via ALB or in-app:
OIDC_ISSUER_URL=""
OIDC_AUDIENCE=""
OIDC_JWKS_URI=""

# ---------- Tenant defaults (OPTIONAL – used by provisioner patterns) ----------
TENANT_NS_PREFIX="tenant-"           # e.g. tenant-acme
TENANT_CPU_REQUEST="100m"
TENANT_MEM_REQUEST="128Mi"
TENANT_CPU_LIMIT="500m"
TENANT_MEM_LIMIT="512Mi"

# ---------- Artifact retention / hygiene (OPTIONAL) ----------
ARTIFACT_RETENTION_DAYS="120"        # S3 artifact bucket retention (days)
ECR_KEEP_LAST="100"                  # Logical – template keeps last ~100 (already set)

# ---------- Bootstrap behavior flags (read by script flags too) ----------
SKIP_GOV="0"                         # "1" to skip GovCloud even if GOV_ACCOUNT_ID set
APPLY_KYVERNO="1"                    # "1" to apply Kyverno post-deploy
